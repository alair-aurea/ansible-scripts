---
- name: Eng.Faster Team Base Playbook
  hosts: "{{ HOSTS }}"
  # If this is windows, cannot escalate privileges
  become: "{{ 'no' if ansible_connection == 'winrm' else 'yes' }}" 
  
  tasks:
    # Print the major and minor version of the OS for information purposes
    - name: Print selected OS
      debug: msg="Selected OS -> {{ ansible_distribution }}; Major version -> {{ ansible_distribution_major_version}}"
        
    
    # Is this windows? If so, executes the windows-base tasks
    - name: Include base file for Windows OSs
      include_tasks: "{{ tasks_windows }}"
      with_first_found:
        - files:
          - "windows-base.yml"
          skip: true
      loop_control:
        loop_var: tasks_windows
      when: ansible_connection == "winrm"
      
    # Is this not windows? If so, executes the linux-base tasks
    - name: Include base file for not Windows OSs
      include_tasks: "{{ tasks_linux }}"
      with_first_found:
        - files:
          - "linux-base.yml"
          skip: true
      loop_control:
        loop_var: tasks_linux
      when: ansible_connection == "ssh"
    
